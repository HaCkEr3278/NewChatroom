import random

def create_character():
    return {
        "name": input("Enter your character's name: "),
        "class": input("Choose your class (e.g., Warrior, Mage, Rogue): "),
        "inventory": [],
        "health": 100,
        "damage": random.randint(10, 20)  # Added base damage
    }

def random_spawn():
    locations = ["a dark forest", "a bustling city", "a desolate desert", "a snowy mountain", "an abandoned castle"]
    return random.choice(locations)

def display_inventory(inventory):
    if inventory:
        print("Your inventory contains:")
        for item in inventory:
            print(f"- {item}")
    else:
        print("Your inventory is empty.")

def fight_beast(character):
    beast_health = random.randint(20, 50)
    print(f"A wild beast appears with {beast_health} health!")

    while beast_health > 0 and character["health"] > 0:
        action = input("Do you attack (a) or try to run (r)? ").lower()
        if action == "a":
            damage = character["damage"]
            beast_health -= damage
            print(f"You hit the beast for {damage} damage. Beast's health is now {beast_health}.")

            if beast_health > 0:
                beast_damage = random.randint(5, 15)
                character["health"] -= beast_damage
                print(f"The beast attacks you for {beast_damage} damage. Your health is now {character['health']}.")

        elif action == "r":
            if random.choice([True, False]):
                print("You successfully escaped!")
                return
            else:
                print("You failed to escape!")
                beast_damage = random.randint(5, 15)
                character["health"] -= beast_damage
                print(f"The beast attacks you for {beast_damage} damage. Your health is now {character['health']}.")
        else:
            print("Invalid action. The beast takes the opportunity to attack!")
            beast_damage = random.randint(5, 15)
            character["health"] -= beast_damage
            print(f"The beast attacks you for {beast_damage} damage. Your health is now {character['health']}.")

    if beast_health <= 0:
        print("You defeated the beast and found a claw as a trophy.")
        character["inventory"].append("beast claw")

    if character["health"] <= 0:
        print("You were defeated by the beast.")

def encounter_event(character):
    events = [
        "You find a treasure chest!",
        "A wild beast appears!",
        "You meet a mysterious traveler.",
        "You stumble upon an ancient artifact.",
        "You fall into a hidden trap!"
    ]
    event = random.choice(events)
    print(event)

    if event == "You find a treasure chest!":
        loot = random.choice(["gold coins", "a magical potion", "a rare gemstone"])
        print(f"Inside, you find {loot}!")
        character["inventory"].append(loot)

    elif event == "A wild beast appears!":
        fight_beast(character)

    elif event == "You meet a mysterious traveler.":
        trade = input("Do you trade with the traveler (y/n)? ").lower()
        if trade == "y":
            item = random.choice(["a map", "a rare herb", "an enchanted ring"])
            print(f"The traveler gives you {item} in exchange for a favor.")
            character["inventory"].append(item)
        else:
            print("The traveler walks away.")

    elif event == "You stumble upon an ancient artifact.":
        artifact = random.choice(["a glowing sword", "a mystical staff", "a shield of light"])
        print(f"You discover {artifact}. It feels powerful!")
        character["inventory"].append(artifact)

    elif event == "You fall into a hidden trap!":
        damage = random.randint(5, 20)
        character["health"] -= damage
        print(f"You took {damage} damage. Your health is now {character['health']}.")

def main():
    print("Welcome to the DnD Adventure Game!")
    character = create_character()
    spawn_location = random_spawn()
    print(f"You spawn in {spawn_location}.")

    while character["health"] > 0:
        print("\nWhat would you like to do?")
        print("1. Check inventory")
        print("2. Explore")
        print("3. Rest")
        print("4. Exit game")

        choice = input("Enter your choice: ")

        if choice == "1":
            display_inventory(character["inventory"])
        elif choice == "2":
            encounter_event(character)
        elif choice == "3":
            heal = random.randint(10, 25)
            character["health"] = min(100, character["health"] + heal)
            print(f"You rested and regained {heal} health. Your health is now {character['health']}.")
        elif choice == "4":
            print("Thank you for playing!")
            break
        else:
            print("Invalid choice. Please try again.")

        if character["health"] <= 0:
            print("You have perished. Game over.")

if __name__ == "__main__":
    main()
