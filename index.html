<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DnD Adventure Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>DnD Adventure Game</h1>
        <div id="game">
            <div id="output"></div>
            <div id="actions"></div>
        </div>
    </div>

    <script>
        class Character {
            constructor(name, charClass) {
                this.name = name;
                this.charClass = charClass;
                this.inventory = [];
                this.health = charClass === "Warrior" ? 150 : 100;
                this.damage = charClass === "Mage" ? 25 : charClass === "Rogue" ? 15 : 20;
                this.cooldown = 0; // For Mage cooldown system
            }
        }

        class Game {
            constructor() {
                this.character = null;
                this.locations = ["a dark forest", "a bustling city", "a desolate desert", "a snowy mountain", "an abandoned castle"];
                this.spawnLocation = "";
                this.storyIndex = 0;
                this.stories = [
                    "You discover a hidden cave filled with glowing crystals. Inside, you find a small chest.",
                    "You come across an abandoned village. The silence is eerie, but something catches your eye.",
                    "You find a sparkling stream and decide to rest. Nearby, there's a strange carved stone.",
                    "You encounter a towering tree with golden leaves. At its base, there seems to be an inscription.",
                    "You walk into a clearing and spot a strange, ancient statue covered in moss."
                ];
                this.init();
            }

            init() {
                const output = document.getElementById("output");
                const actions = document.getElementById("actions");
                output.innerHTML = "<p>Welcome to the DnD Adventure Game!</p>";

                actions.innerHTML = `
                    <label>Enter your character's name: <input id="charName" type="text"></label><br>
                    <label>Choose your class: 
                        <select id="charClass">
                            <option value="Warrior">Warrior</option>
                            <option value="Mage">Mage</option>
                            <option value="Rogue">Rogue</option>
                        </select>
                    </label><br>
                    <button onclick="game.createCharacter()">Start Game</button>
                `;
            }

            createCharacter() {
                const name = document.getElementById("charName").value;
                const charClass = document.getElementById("charClass").value;

                if (!name) {
                    alert("Please enter a name.");
                    return;
                }

                this.character = new Character(name, charClass);
                this.spawnLocation = this.randomSpawn();

                this.updateOutput(`<p>You are ${this.character.name}, the ${this.character.charClass}. You spawn in ${this.spawnLocation}.</p>`);
                this.showActions();
            }

            randomSpawn() {
                return this.locations[Math.floor(Math.random() * this.locations.length)];
            }

            updateOutput(message) {
                const output = document.getElementById("output");
                output.innerHTML += message;
            }

            showActions() {
                const actions = document.getElementById("actions");
                actions.innerHTML = `
                    <button onclick="game.checkInventory()">Check Inventory</button>
                    <button onclick="game.explore()">Explore</button>
                    <button onclick="game.rest()">Rest</button>
                    <button onclick="game.startFight()">Start Fight</button>
                    <button onclick="game.exitGame()">Exit Game</button>
                `;
            }

            checkInventory() {
                if (this.character.inventory.length === 0) {
                    this.updateOutput("<p>Your inventory is empty.</p>");
                } else {
                    this.updateOutput(`<p>Your inventory contains: ${this.character.inventory.join(", ")}.</p>`);
                }
            }

            explore() {
                if (this.storyIndex < this.stories.length) {
                    const story = this.stories[this.storyIndex];
                    this.updateOutput(`<p>${story}</p>`);
                    this.storyIndex++;
                } else {
                    this.updateOutput("<p>You have explored all the stories available.</p>");
                }
            }

            startFight() {
                let beastHealth = Math.floor(Math.random() * 31) + 20;
                this.updateOutput(`<p>A wild beast appears with ${beastHealth} health!</p>`);

                const fightInterval = setInterval(() => {
                    if (this.character.health <= 0 || beastHealth <= 0) {
                        clearInterval(fightInterval);
                        if (this.character.health <= 0) {
                            this.updateOutput("<p>You have perished. Game over.</p>");
                            this.endGame();
                        } else {
                            this.updateOutput("<p>You defeated the beast and found a claw as a trophy.</p>");
                            this.character.inventory.push("beast claw");
                        }
                        return;
                    }

                    if (this.character.cooldown > 0) {
                        this.character.cooldown--;
                        this.updateOutput(`<p>${this.character.name} is preparing their next move.</p>`);
                    } else {
                        let playerDamage = 0;
                        if (this.character.charClass === "Mage") {
                            const spell = prompt("Choose a spell: Frostbolt, Lightning, or Flame").toLowerCase();
                            if (spell === "frostbolt") {
                                playerDamage = 20;
                                if (Math.random() < 0.25) {
                                    this.updateOutput("<p>The beast is frozen and skips its next turn!</p>");
                                    beastHealth -= playerDamage;
                                    return;
                                }
                            } else if (spell === "lightning") {
                                playerDamage = 15;
                                this.updateOutput("<p>The beast is zapped and takes damage every turn!</p>");
                            } else if (spell === "flame") {
                                playerDamage = 10;
                                this.updateOutput("<p>The beast is burning and will take damage over time!</p>");
                            }
                            this.character.cooldown = 1; // Mage cooldown
                        } else if (this.character.charClass === "Rogue") {
                            playerDamage = 15;
                            if (Math.random() < 0.5) {
                                this.updateOutput("<p>You dodged the beast's attack!</p>");
                                beastHealth -= playerDamage;
                                return;
                            }
                        } else {
                            playerDamage = 20;
                        }

                        beastHealth -= playerDamage;
                        this.updateOutput(`<p>You dealt ${playerDamage} damage to the beast. Beast's health: ${beastHealth}</p>`);
                    }

                    const beastDamage = Math.floor(Math.random() * 11) + 5;
                    this.character.health -= beastDamage;
                    this.updateOutput(`<p>The beast attacks you for ${beastDamage} damage. Your health: ${this.character.health}</p>`);
                }, 2000);
            }

            rest() {
                const heal = Math.floor(Math.random() * 16) + 10;
                this.character.health = Math.min(this.character.charClass === "Warrior" ? 150 : 100, this.character.health + heal);
                this.updateOutput(`<p>You rested and regained ${heal} health. Your health is now ${this.character.health}.</p>`);
            }

            exitGame() {
                this.updateOutput("<p>Thank you for playing!</p>");
                this.endGame();
            }

            endGame() {
                document.getElementById("actions").innerHTML = "";
            }
        }

        const game = new Game();
    </script>
</body>
</html>
