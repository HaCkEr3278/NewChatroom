<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mikasa vs Pieck Smash Simulator</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #eee; }
        canvas { display: block; margin: 0; padding: 0; }
        #gameOver { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: red; font-size: 50px; display: none; }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>
<div id="gameOver">GAME OVER</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Set up canvas size
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Characters and game state
    let mikasa = { x: 100, y: canvas.height - 150, width: 50, height: 100, color: 'blue', health: 100, isJumping: false, velocityY: 0 };
    let pieck = { x: canvas.width - 150, y: canvas.height - 150, width: 50, height: 100, color: 'green', health: 100 };
    let keys = {};

    // Game control variables
    let attackCooldown = false;

    // Draw characters and health bars
    function drawCharacter(character) {
        ctx.fillStyle = character.color;
        ctx.fillRect(character.x, character.y, character.width, character.height);
    }

    function drawHealthBar(character) {
        ctx.fillStyle = 'red';
        ctx.fillRect(character.x, character.y - 20, character.width, 10);
        ctx.fillStyle = 'green';
        ctx.fillRect(character.x, character.y - 20, (character.width * character.health) / 100, 10);
    }

    function checkCollisions() {
        // Mikasa's attack range
        if (mikasa.x + mikasa.width > pieck.x && mikasa.x < pieck.x + pieck.width &&
            mikasa.y < pieck.y + pieck.height && mikasa.y + mikasa.height > pieck.y) {
            pieck.health -= 1; // Mikasa hits Pieck
        }

        // Pieck's attack range
        if (pieck.x + pieck.width > mikasa.x && pieck.x < mikasa.x + mikasa.width &&
            pieck.y < mikasa.y + mikasa.height && pieck.y + pieck.height > mikasa.y) {
            mikasa.health -= 1; // Pieck hits Mikasa
        }
    }

    // Handle movement and attacks
    function handleMovement() {
        if (keys['w'] && !mikasa.isJumping) {
            mikasa.velocityY = -12; // Mikasa jumps
            mikasa.isJumping = true;
        }
        if (keys['a']) mikasa.x -= 5; // Mikasa moves left
        if (keys['d']) mikasa.x += 5; // Mikasa moves right

        if (keys['ArrowUp'] && !pieck.isJumping) {
            pieck.velocityY = -12; // Pieck jumps
            pieck.isJumping = true;
        }
        if (keys['ArrowLeft']) pieck.x -= 5; // Pieck moves left
        if (keys['ArrowRight']) pieck.x += 5; // Pieck moves right
    }

    // Jumping physics
    function handleJump() {
        // Mikasa's jump logic
        if (mikasa.isJumping) {
            mikasa.y += mikasa.velocityY;
            mikasa.velocityY += 0.8; // Gravity effect
            if (mikasa.y >= canvas.height - 150) { // When Mikasa lands
                mikasa.y = canvas.height - 150;
                mikasa.isJumping = false;
                mikasa.velocityY = 0;
            }
        }

        // Pieck's jump logic
        if (pieck.isJumping) {
            pieck.y += pieck.velocityY;
            pieck.velocityY += 0.8; // Gravity effect
            if (pieck.y >= canvas.height - 150) { // When Pieck lands
                pieck.y = canvas.height - 150;
                pieck.isJumping = false;
                pieck.velocityY = 0;
            }
        }
    }

    // Handle attacks
    function handleAttack() {
        if (keys[' '] && !attackCooldown) { // Mikasa's normal attack (space)
            attackCooldown = true;
            setTimeout(() => attackCooldown = false, 500); // Attack cooldown
        }

        if (keys['Enter'] && !attackCooldown) { // Pieck's normal attack (Enter)
            attackCooldown = true;
            setTimeout(() => attackCooldown = false, 500); // Attack cooldown
        }
    }

    // End game if any character's health reaches 0
    function checkGameOver() {
        if (mikasa.health <= 0 || pieck.health <= 0) {
            document.getElementById('gameOver').style.display = 'block';
        }
    }

    // Main game loop
    function gameLoop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        handleMovement();
        handleJump();
        handleAttack();
        checkCollisions();
        checkGameOver();

        drawCharacter(mikasa);
        drawCharacter(pieck);
        drawHealthBar(mikasa);
        drawHealthBar(pieck);

        requestAnimationFrame(gameLoop);
    }

    // Set up key event listeners
    document.addEventListener('keydown', (e) => keys[e.key] = true);
    document.addEventListener('keyup', (e) => keys[e.key] = false);

    // Start game
    gameLoop();

</script>

</body>
</html>
